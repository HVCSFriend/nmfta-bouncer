 icon@hades  ~  curl http://localhost:8080/v1/whitelists                               
{
  "msg": "Missing Authorization Header"
}
 icon@hades  ~  curl -d "username=icon&password=test&grant_type=password" http://localhost:8080/v1/login
{
    "message": "User does not exist"
}
 icon@hades  ~  curl -d "username=icon&password=test" http://localhost:8080/v1/register                 
{
    "message": "all good with user creation"
}
 icon@hades  ~  curl -d "username=icon&password=test&grant_type=password" http://localhost:8080/v1/login
{
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJjNzM5ZDVhOS04YjQ0LTRkODUtYjY1NC0yNTYzNDc5NjlkMjkiLCJleHAiOjE1MjUzMTYwNDYsImZyZXNoIjpmYWxzZSwiaWF0IjoxNTI1MzE1MTQ2LCJ0eXBlIjoiYWNjZXNzIiwibmJmIjoxNTI1MzE1MTQ2LCJpZGVudGl0eSI6Imljb24ifQ.oLpoduILXcz7gLDVZiVAzlL22ncbjdyOXNR0n4ce0pI", 
    "claim_level": "complete", 
    "expires_in": 3600, 
    "token_type": "bearer"
}
 icon@hades  ~  curl -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJjNzM5ZDVhOS04YjQ0LTRkODUtYjY1NC0yNTYzNDc5NjlkMjkiLCJleHAiOjE1MjUzMTYwNDYsImZyZXNoIjpmYWxzZSwiaWF0IjoxNTI1MzE1MTQ2LCJ0eXBlIjoiYWNjZXNzIiwibmJmIjoxNTI1MzE1MTQ2LCJpZGVudGl0eSI6Imljb24ifQ.oLpoduILXcz7gLDVZiVAzlL22ncbjdyOXNR0n4ce0pI" http://localhost:8080/v1/whitelists
{
    "IPAddresses": [], 
    "Result": {
        "Message": "Showing All Whitelisted IPs", 
        "Status": "Success"
    }
}
 icon@hades  ~  curl -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJjNzM5ZDVhOS04YjQ0LTRkODUtYjY1NC0yNTYzNDc5NjlkMjkiLCJleHAiOjE1MjUzMTYwNDYsImZyZXNoIjpmYWxzZSwiaWF0IjoxNTI1MzE1MTQ2LCJ0eXBlIjoiYWNjZXNzIiwibmJmIjoxNTI1MzE1MTQ2LCJpZGVudGl0eSI6Imljb24ifQ.oLpoduILXcz7gLDVZiVAzlL22ncbjdyOXNR0n4ce0pI" -d "IPv4=192.168.1.1&Comments=unblock%20gateway" http://localhost:8080/v1/whitelists/create
{
    "Result": {
        "Message": "IP Added to whitelist", 
        "Status": "Success"
    }
}
 icon@hades  ~  curl -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJjNzM5ZDVhOS04YjQ0LTRkODUtYjY1NC0yNTYzNDc5NjlkMjkiLCJleHAiOjE1MjUzMTYwNDYsImZyZXNoIjpmYWxzZSwiaWF0IjoxNTI1MzE1MTQ2LCJ0eXBlIjoiYWNjZXNzIiwibmJmIjoxNTI1MzE1MTQ2LCJpZGVudGl0eSI6Imljb24ifQ.oLpoduILXcz7gLDVZiVAzlL22ncbjdyOXNR0n4ce0pI" http://localhost:8080/v1/whitelists
{
    "IPAddresses": [
        "192.168.1.1"
    ], 
    "Result": {
        "Message": "Showing All Whitelisted IPs", 
        "Status": "Success"
    }
}
 icon@hades  ~  curl -d "IPv4=192.168.1.2&Comments=unblock%20evil%20host" http://localhost:8080/v1/whitelists/create
{
  "msg": "Missing Authorization Header"
}
 icon@hades  ~  curl -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJjNzM5ZDVhOS04YjQ0LTRkODUtYjY1NC0yNTYzNDc5NjlkMjkiLCJleHAiOjE1MjUzMTYwNDYsImZyZXNoIjpmYWxzZSwiaWF0IjoxNTI1MzE1MTQ2LCJ0eXBlIjoiYWNjZXNzIiwibmJmIjoxNTI1MzE1MTQ2LCJpZGVudGl0eSI6Imljb24ifQ.oLpoduILXcz7gLDVZiVAzlL22ncbjdyOXNR0n4ce0pI" http://localhost:8080/v1/whitelists
{
    "IPAddresses": [
        "192.168.1.1"
    ], 
    "Result": {
        "Message": "Showing All Whitelisted IPs", 
        "Status": "Success"
    }
}
 icon@hades  ~  curl -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI0YzEzZjVmZC0yM2M4LTRjMDMtODM3NS1mYzM3YzRmZjJhN2UiLCJleHAiOjE1MjUzMTU1MTQsImZyZXNoIjpmYWxzZSwiaWF0IjoxNTI1MzE0NjE0LCJ0eXBlIjoiYWNjZXNzIiwibmJmIjoxNTI1MzE0NjE0LCJpZGVudGl0eSI6Imljb24ifQ.kNBrlgXctnJHlodeZO1v4-TzqCynYWnK086mXitBNQQ" -d "IPv4=192.168.1.1&Comments=try%20to%20add%20again" http://localhost:8080/v1/whitelists/create
{
    "Result": {
        "Message": "IP exists in system", 
        "Status": "Error"
    }
}
 icon@hades  ~  curl -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJjNzM5ZDVhOS04YjQ0LTRkODUtYjY1NC0yNTYzNDc5NjlkMjkiLCJleHAiOjE1MjUzMTYwNDYsImZyZXNoIjpmYWxzZSwiaWF0IjoxNTI1MzE1MTQ2LCJ0eXBlIjoiYWNjZXNzIiwibmJmIjoxNTI1MzE1MTQ2LCJpZGVudGl0eSI6Imljb24ifQ.oLpoduILXcz7gLDVZiVAzlL22ncbjdyOXNR0n4ce0pI" -d "IPv4=192.168.1.2&Comments=add%20host" http://localhost:8080/v1/whitelists/create
{
    "Result": {
        "Message": "IP Added to whitelist", 
        "Status": "Success"
    }
}
 icon@hades  ~  curl -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJjNzM5ZDVhOS04YjQ0LTRkODUtYjY1NC0yNTYzNDc5NjlkMjkiLCJleHAiOjE1MjUzMTYwNDYsImZyZXNoIjpmYWxzZSwiaWF0IjoxNTI1MzE1MTQ2LCJ0eXBlIjoiYWNjZXNzIiwibmJmIjoxNTI1MzE1MTQ2LCJpZGVudGl0eSI6Imljb24ifQ.oLpoduILXcz7gLDVZiVAzlL22ncbjdyOXNR0n4ce0pI" http://localhost:8080/v1/whitelists
{
    "IPAddresses": [
        "192.168.1.2", 
        "192.168.1.1"
    ], 
    "Result": {
        "Message": "Showing All Whitelisted IPs", 
        "Status": "Success"
    }
}

